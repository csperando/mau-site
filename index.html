<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="description" content=""/>
        <title>Coleman and Ty Play Mau</title>
        <link rel="icon" type="image/x-icon" href="./favicon.ico"/>

        <!-- Import Vue -->
        <script src="./js/libs/vue.js"></script>

        <!-- Styles -->
        <link rel="stylesheet" type="text/css" href="./css/main.css"/>
        <link rel="preload" as="style" href="./css/main.css"/>

        <!-- Component Styles -->
        <link rel="stylesheet" type="text/css" href="./css/header.css"/>
        <link rel="preload" as="style" href="./css/header.css"/>

        <link rel="stylesheet" type="text/css" href="./css/modal.css"/>
        <link rel="preload" as="style" href="./css/modal.css"/>

        <link rel="stylesheet" type="text/css" href="./css/newGame.css"/>
        <link rel="preload" as="style" href="./css/newGame.css"/>

        <link rel="stylesheet" type="text/css" href="./css/stats.css"/>
        <link rel="preload" as="style" href="./css/stats.css"/>

        <link rel="stylesheet" type="text/css" href="./css/forms.css"/>
        <link rel="preload" as="style" href="./css/forms.css"/>


    </head>

    <body>
        <div class="background"></div>

        <div id="app">
            <dashboard></dashboard>
        </div>


        <script type="text/x-template" id="mau-login-component">
            <div class="modal-form-wrap">
                <form @submit.prevent="loginUser" class="flex-col col-center small-gap">
                    <div class="flex-row small-gap">
                        <div class="flex-col">
                            <label>Username:</label>
                            <input v-model="username" type="text" name="username"/>
                        </div>
                        <div class="flex-col">
                            <label>Password:</label>
                            <input v-model="password" type="password" name="password"/>
                        </div>
                    </div>
                    <div class="flex-row flex-center">
                        <button type="submit" class="std-btn">login</button>
                    </div>
                </form>
            </div>
        </script>

        <script type="text/x-template" id="mau-signup-component">
            <div class="modal-form-wrap">
                <form @submit.prevent="signupUser" class="flex-col col-center small-gap">
                    <div class="flex-row small-gap">
                        <div class="flex-col">
                            <label>First name:</label>
                            <input v-model="firstName" type="text" name="firstName" required/>
                        </div>
                        <div class="flex-col">
                            <label>Last name:</label>
                            <input v-model="lastName" type="text" name="lastName" required/>
                        </div>
                    </div>
                    <div class="flex-row small-gap">
                        <div class="flex-col">
                            <label>Email:</label>
                            <input v-model="email" type="text" name="email" required/>
                        </div>
                        <div class="flex-col">
                            <label>Username:</label>
                            <input v-model="username" type="text" name="username" required/>
                        </div>
                    </div>
                    <div class="flex-row small-gap">
                        <div class="flex-col">
                            <label>Password:</label>
                            <input v-model="password" type="password" name="password" required/>
                        </div>
                        <div class="flex-col">
                            <label>Confirm:</label>
                            <input v-model="confirm" type="password" name="confirm" required/>
                        </div>
                    </div>
                    <div class="flex-row flex-center">
                        <button type="submit" class="std-btn">Signup</button>
                    </div>
                </form>
            </div>
        </script>

        <script type="text/x-template" id="mau-user-header-component">
            <div v-if="user">
                <div class="flex-row flex-center space-around">
                    <img class="tilted" src="./images/6Spades.svg" alt="six of spades playing card" height="100" width="100"/>
                    <div class="flex-col small-gap">
                        <p class="text-center title">{{user.username}}</p>
                        <p class="text-center">{{user.firstName}} {{user.lastName}}</p>
                    </div>
                </div>
            </div>
        </script>

        <script type="text/x-template" id="mau-settings-component">
            <div class="modal-form-wrap">
                <form class="flex-col col-center small-gap">
                    <div class="flex-row small-gap">
                        <div class="flex-row flex-center small-gap">
                            <div class="flex-col flex-center">
                                <p class="text-center green"><b>Dark Theme</b></p>
                                <label>off</label>
                            </div>
                            <input type="checkbox" name="darkTheme"/>
                        </div>
                    </div>
                </form>
            </div>
        </script>

        <script type="text/x-template" id="mau-round-component">
            <div class="flex-row row-space-between">
                <div class="round-row-outer flex-row flex-center">
                    <span class="green"><b>Round {{ index }}</b></span>
                </div>
                <div class="round-row-inner">
                    <div class="flex-col">
                        <div class="flex-col">
                            <label class="text-center" for="round-winner">Winner</label>
                            <input type="text" required v-model="round.winner.name"/>
                        </div>

                        <div class="flex-col">
                            <label class="text-center" for="round-loser">Loser</label>
                            <input type="text" required v-model="round.loser.name"/>
                        </div>

                        <div class="flex-col">
                            <label class="text-center" for="round-1-points">Points</label>
                            <div class="flex-row flex-center">
                                <input type="number" required v-model="round.points"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div @click="deleteRound" class="round-row-outer flex-row flex-center delete-round">
                    <img src="./images/icons/trash.svg" alt="trashcan icon - delete round" height="30" width="30"/>
                </div>
            </div>
        </script>

        <script type="text/x-template" id="mau-new-game-component">
            <form @submit.prevent="submitGame">
                <p class="text-center"><b>Add a New Game!</b></p>

                <div class="space-around">
                    <p class="text-center"><b>Overall</b></p>
                    <div class="two-col">
                        <div class="flex-col">
                            <label for="winner">Winner</label>
                            <input v-model="game.winner.name" required type="text" name="overall-winner"/>
                        </div>
                        <div class="flex-col">
                            <label for="loser">Loser</label>
                            <input v-model="game.loser.name" required type="text" name="overall-loser"/>
                        </div>
                    </div>

                    <div class="flex-col">
                        <label class="text-center" for="score">Score</label>
                        <div class="flex-row flex-center">
                            <input v-model="game.overall[0]" required type="number" name="overall-score-a"/>
                            <span>&nbsp;&nbsp;<em>to</em>&nbsp;&nbsp;</span>
                            <input v-model="game.overall[1]" required type="number" name="overall-score-b"/>
                        </div>
                    </div>
                </div>

                <div class="space-around">
                    <p class="text-center"><b>Rounds</b></p>
                    <new-round
                        v-for="(round, index) in game.rounds"
                        :round="round"
                        :key="round.id"
                        :index="game.rounds.indexOf(round) + 1"
                        @deleteRound="deleteRound"
                        ></new-round>
                </div>

                <div class="space-around">
                    <div class="flex-row flex-center">
                        <div @click="newRound" class="new-round-btn flex-row flex-center small-gap">
                            <img src="./images/icons/plus.svg" alt="plus sign" width="16" height="16"/>
                            <span>add round</span>
                        </div>
                    </div>
                </div>

                <div class="space-around">
                    <div class="flex-row flex-center">
                        <input type="submit" value="Submit"/>
                    </div>
                </div>

            </form>
        </script>

        <script type="text/x-template" id="mau-menu-component">
            <div>
                <div v-show="loggedOut" class="flex-col flex-center small-gap">
                    <span class="modal-menu-option"
                        @click="toggleLogin"
                        >login</span>
                    <login
                        @authStart="showLoader"
                        @authEnd="hideLoader"
                        @loggedIn="loggedIn"
                        v-show="activeForm == 'login'"
                        ></login>

                    <span class="modal-menu-option"
                        @click="toggleSignup"
                        >signup</span>
                    <signup
                        @authStart="showLoader"
                        @authEnd="hideLoader"
                        v-show="activeForm == 'signup'"
                        ></signup>
                </div>

                <div v-show="!loggedOut" class="flex-col flex-center small-gap">
                    <user-header :user="user"></user-header>

                    <span class="modal-menu-option"
                        @click="toggleSettings"
                        >settings</span>
                    <settings v-show="activeForm == 'settings'"></settings>

                    <span
                        v-if="isAdmin"
                        class="modal-menu-option"
                        @click="toggleNewGame"
                        >new game</span>
                    <new-game
                        @loadingStart="showLoader"
                        @loadingEnd="hideLoader"
                        v-show="activeForm == 'newGame'"
                        ></new-game>

                    <span @click="logout" class="modal-menu-option">logout</span>
                </div>

                <div v-show="loading" class="mau-menu-loading-wrap">
                    <div class="dark-background"></div>
                    <img src="./images/gears.svg" width="150" height="150" alt="rotating loading icon"/>
                </div>
            </div>
        </script>

        <script type="text/x-template" id="mau-modal-view-component">
            <div v-if="view == 'newGame'">
                <new-game></new-game>
            </div>
            <div v-else-if="view == 'menu'">
                <mau-menu
                    @loggedIn="loggedIn"
                    :user="user"
                    ></mau-menu>
            </div>
            <div v-else>
                <span>Error</span>
            </div>
        </script>

        <script type="text/x-template" id="mau-modal-component">
            <div
                @click="hideModal"
                v-show="modalActive"
                class="modal">
                <div class="dark-background"></div>
                <div class="modal-view">
                    <modal-view
                        view="menu"
                        @loggedIn="loggedIn"
                        :user="user"
                        ></modal-view>
                </div>
            </div>
        </script>

        <script type="text/x-template" id="mau-header-component">
            <header>
                <nav class="mau-nav">
                    <span></span>
                    <div @click="toggleModal">
                        <img src="./images/icons/menu.svg" alt="menu" width="30" height="30"/>
                    </div>
                </nav>
            </header>
        </script>

        <script type="text/x-template" id="mau-stats-component">
            <div>

                <div v-if="!loadingStats" class="mau-stats">
                    <div class="mau-stats-wins">
                        <p class="text-center title">Wins</p>
                        <div class="flex-row flex-center small-gap">
                            <span class="mau-stat text-right green">{{stats.wins.Ty}}</span>
                            <span class="mau-stat">{{stats.wins.Coleman}}</span>
                        </div>
                    </div>

                    <div class="mau-stats-winPercent">
                        <p class="text-center title">Win Percentage</p>
                        <div class="flex-row flex-center small-gap">
                            <span class="mau-stat text-right green">{{stats.winPercent.Ty}}</span>
                            <span class="mau-stat">{{stats.winPercent.Coleman}}</span>
                        </div>
                    </div>

                    <div class="mau-stats-streak">
                        <p class="text-center title">Longest Streak (Rounds)</p>
                        <div class="flex-row flex-center small-gap">
                            <span class="mau-stat text-right green">{{stats.longestStreak.Ty}}</span>
                            <span class="mau-stat">{{stats.longestStreak.Coleman}}</span>
                        </div>
                    </div>

                    <div class="mau-stats-savage">
                        <p class="text-center title">Most Savage Round</p>
                        <div class="flex-row flex-center small-gap">
                            <span class="mau-stat text-right green">{{stats.savage.Ty}}</span>
                            <span class="mau-stat">{{stats.savage.Coleman}}</span>
                        </div>
                    </div>
                </div> <!-- end mau-stats -->

                <div v-else class="mau-stats mau-stats-loading">
                    <div class="flex-row flex-center">
                        <span class="text-center title">
                            Loading Stats
                        </span>
                        <img class="align-bottom" src="./images/dots.svg" width="40" height="30" alt="disapearing ellipses loading animation"/>
                    </div>
                    <div class="flex-row flex-center small-gap">
                        <span class="mau-stat green text-right">T</span>
                        <span class="mau-stat">C</span>
                    </div>
                </div>

            </div>
        </script>

        <script type="text/x-template" id="dashboard-component">
            <div>
                <mau-header @toggle-modal="toggleModal"></mau-header>

                <main>
                    <mau-stats
                        :games="games"
                        :loadingStats="loadingStats"
                        ></mau-stats>
                </main>

                <modal
                    @hide-modal="hideModal"
                    :modalActive="modalActive"
                    @loggedIn="loggedIn"
                    :user="user"
                    ></modal>
            </div>
        </script>

        <script src="./components/app.vue"></script>

    </body>
</html>
